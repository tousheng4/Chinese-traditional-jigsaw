# “微注释”知识卡功能需求分析文档（PRD）

## 0. 文档信息
- 功能名称：微注释（Micro-Annotation）
- 所属模块：拼图完成结算 / 轻知识系统
- 目标：在不打断“完成的情绪峰值”的前提下，向用户传递 1–2 条最关键、最具辨识度的文化知识点，并提供可选的“展开阅读”路径。
- 技术栈：SwiftUI（本地资源优先；可扩展在线更新）
- 适用主题：年画 / 京剧脸谱 / 敦煌壁画 / 国画（以及未来扩展主题）

---

## 1. 背景与问题定义

### 1.1 背景
拼图完成的瞬间是玩家情绪最集中的窗口：满足、沉浸、审美回响。传统百科式长文解释容易破坏节奏，并造成认知负担。  
“微注释”旨在把知识呈现从“讲解”改为“点醒”：用极少的文字让玩家获得“我看懂了一点”的即时收益，同时不妨碍继续下一关。

### 1.2 要解决的问题
- 完成后信息过多导致用户跳过，知识内容被“忽略化”。
- 传统文化知识门槛高，缺少“进入点”（entry point）。
- 内容呈现与玩法割裂，缺乏与图像细节的强绑定。

---

## 2. 产品目标与非目标

### 2.1 产品目标（P0）
1) 完成关卡后自动呈现微注释：**仅 1–2 句**，在 **≤ 3 秒** 内可读完。  
2) 支持“点开扩展”查看更完整内容（可选，不强迫）。  
3) 知识点与当前作品强绑定，可追溯来源字段（至少在内容数据层具备）。  
4) 不影响结算页核心信息（用时、步数、完成奖励），不打断“继续下一关”。

### 2.2 非目标（P0 不做）
- 不做长篇百科检索与跨作品联想推荐（可作为 P1/P2）。
- 不做强交互考试式答题（后续可扩展）。
- 不做依赖网络的实时拉取（MVP 以本地内容为主）。

---

## 3. 用户体验与核心原则

### 3.1 呈现原则
- **短**：只给 1–2 条关键句（每句建议 18–34 个汉字区间，可上下浮动）。
- **准**：避免模糊泛泛的“艺术价值很高”式陈词；必须是“可验证、可解释”的事实或符号含义。
- **贴图**：知识点应紧扣画面元素（色彩、纹样、人物身份、构图、题跋、工艺）。
- **可忽略**：用户可以不展开，不影响继续游玩。
- **可扩展**：展开页承载更完整信息，分段短小，不形成压迫性长文。

### 3.2 语气风格
- 书面但轻盈，避免说教；以“提示/注脚”的气质出现。
- 尽量使用“因果/对照/定义”结构，让句子更有信息密度。

---

## 4. 交互流程（P0）

### 4.1 触发时机
- 触发条件：关卡首次完成或每次完成均可触发（需明确口径）
  - 建议：**首次完成强展示**，重复完成弱展示或折叠展示（见 5.3）
- 触发位置：结算页（Completion Screen）中部或下部，避免遮挡主要按钮

### 4.2 默认展示形态（微注释卡）
- 卡片内容：
  - 标题（可选）：如“微注释”
  - 句子 1（必填）
  - 句子 2（可选）
  - “展开”按钮（chevron 或“了解更多”）
- 操作：
  - 点击“展开”进入扩展页（sheet / push 都可）
  - 点击卡片空白区域不应误触展开（防误操作）

### 4.3 扩展页（详情阅读）
- 内容构成（建议分组）：
  1) 作品信息：名称/时代/流派/题材（可选）
  2) 关键点详述：以 2–4 个小段落呈现，每段 ≤ 80–120 字
  3) 图像要素解读：可列 2–5 条要素（如“红脸”“回纹”“飞天飘带”）
  4) 来源与版权：数据层保留 `source`，UI 可在底部折叠呈现
- 操作：
  - 上滑阅读，下滑关闭（Sheet）或返回（Navigation）

---

## 5. 规则口径与策略

### 5.1 微注释条数与长度约束（必须写死）
- 默认显示：1–2 条
- 长度建议：
  - 句子 1：18–34 字
  - 句子 2：18–34 字
- 超长处理：
  - 不允许自动截断后省略（会破坏信息）；应在内容编辑阶段满足约束
  - 工具侧可做“内容校验”提示（见 9.2）

### 5.2 内容选择策略（如何决定显示哪两句）
每关卡可配置一个“微注释集合”，系统从中选 1–2 条：
- 规则 A（推荐）：固定显示“最重要的 1 条 + 随机 1 条”
  - 保证核心信息稳定输出，同时提供复玩新鲜感
- 规则 B：按玩家行为自适应（P1）
  - 若玩家使用提示较多，优先显示“入门解释”
  - 若玩家低提示高效率，优先显示“深一点的注脚”

### 5.3 首次完成 vs 重复完成策略
- 首次完成：默认展开卡片（视觉权重更高）
- 重复完成：
  - 卡片折叠为一行“本关注脚：……”（低干扰）
  - 或提供设置项“重复通关不再显示微注释”（用户可控）

---

## 6. 内容体系与数据模型

### 6.1 数据实体（概念模型）
- `Artwork`
  - `id`
  - `title`
  - `category`（年画/脸谱/敦煌/国画）
  - `dynastyOrPeriod`（可选）
  - `tags`（可选）
  - `sourceInfo`（版权/来源/馆藏等）
- `MicroAnnotationPack`
  - `artworkId`
  - `microNotes: [MicroNote]`（至少 1 条）
  - `detailSections: [DetailSection]`（扩展页内容）
- `MicroNote`
  - `id`
  - `text`
  - `priority`（0/1/2…，用于“最重要的 1 条”）
  - `tone`（入门/进阶，可选）
  - `relatedHotspotIds`（与画面热点关联，P1）
- `DetailSection`
  - `title`
  - `body`
  - `references`（可选）

### 6.2 内容存储形式（建议）
- 本地 JSON（便于策展迭代）：
  - `artworks.json`
  - `micro_notes.json`
- 版本号：
  - `contentVersion` 字段用于后续增量更新与兼容

---

## 7. UI 需求（P0）

### 7.1 结算页卡片布局要求
- 不遮挡主要按钮（“下一关”“重玩”“返回列表”）
- 允许一屏内完成：
  - 完成反馈（主视觉）
  - 核心统计
  - 微注释卡（不超过 3 行文本高度）
- 动效：
  - 卡片淡入即可；避免过强弹跳动画（遵从减少动态效果设置）

### 7.2 扩展页排版要求
- 段落短，行距舒适
- 标题层级清晰
- 支持动态字体（Dynamic Type）
- VoiceOver 可读

---

## 8. 性能与稳定性要求
- 内容加载必须轻量：本地 JSON 可在应用启动时缓存，或按需加载对应 artwork
- 结算页出现微注释不应增加明显延迟
- 不允许网络请求阻塞结算展示（若未来接入在线内容，需有本地兜底）

---

## 9. 内容生产与质量控制（关键）

### 9.1 内容编辑规范（给策展/文案）
- 每条微注释必须满足：
  - 与画面元素直接相关（可指出“是什么/为什么”）
  - 可被资料支持（至少在内部资料可追溯）
  - 避免价值判断式空话
- 句式建议：
  - 定义式：“‘回纹’是……，常寓意……”
  - 对照式：“红脸多表忠勇，白脸常指奸诈（但也有例外）”
  - 因果式：“矿物颜料颗粒感明显，因此……”
- 禁止：
  - 过度绝对化（“一定”“必然”）除非有严格来源
  - 争议观点不标注“学界有不同说法”

### 9.2 内容校验（工程侧）
构建一个内容校验步骤（可在 debug 或 CI 执行）：
- 微注释条数 ≥ 1
- 每条字数在阈值内
- 文本无换行/非法字符
- 每个 artworkId 都能映射到对应 pack
- 缺失时降级策略：展示“今日注脚暂缺”并记录日志（不崩溃）

---

## 10. 边界场景与降级策略
- 某关卡无微注释数据：
  - 结算页不显示卡片或显示“注脚待补充”
- 扩展页内容为空：
  - “展开”按钮隐藏
- 多语言（若未来支持）：
  - 缺失语言时回退到默认语言
- 用户开启“减少动态效果/大字体”：
  - 卡片高度可自适应；必要时只显示 1 条微注释

---

## 11. 验收标准（DoD）
- 完成关卡后，结算页稳定显示 1–2 条微注释（首通必达）
- “展开”进入扩展页，内容可读且可返回
- 重复通关按策略降低干扰（折叠或可关闭）
- 无内容时不崩溃，有合理降级提示
- 动态字体与 VoiceOver 基本可用

---

## 12. 迭代路线（可选）
- P1：热点标注（在完成整图上点某元素弹出对应注脚）
- P1：基于玩家行为的注脚推荐（入门/进阶）
- P2：内容在线更新与 A/B 测试（不同注脚对留存影响）
- P2：与成就联动（“读完 10 条注脚解锁‘小注学人’”）
